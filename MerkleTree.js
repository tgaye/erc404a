const keccak256 = require("keccak256");
const { default: MerkleTree } = require("merkletreejs");
const fs = require("fs");

const address = [
  "0x2b18A312C8c091BB99771959671551BB9308616d",
  "0x89Ab2163839CAd9601E9cFb9d8Bb5d8De84F7274",
  "0x48ef7888c5d419Eee8b14e1d797Ed1453aB2FE4c",
  "0xf09ABdaF9C038b21B900B718E6e1632003D391BD",
  "0xff06904EeB5358F243FdA97C902899786f83cbaD",
  "0x3bd36ecad8af17c2a1e62a71e90500869e8448a4",
  "0x55390765f0F2EBaa9D18e36A6fB79DdC8857211c",
  "0x018c890DDF24b2E9Cd7d43f4Fd0d2C1e776F0257",
  "0xE9A8056b1196129E3A3D3Ed9F22282ef5a3755A1",
  "0x4fA6B317E262838207DA9d3D59CE2319f3F8fe55",
  "0xc087e32df8F35525343b04622828370C068ebf12",
  "0xF00f2B1E90B5Df2dbE078B792Df6f19DD6540CF4",
  "0x55e174227d8451a5f763E9c45c261f9dC5DC517d",
  "0xe0B03e87830219Ea34C543ca933EDdA883011b49",
  "0x377dF8F2fEE7A9d63F9411b6e33398e243E50eB7",
  "0x1cDdb5933D4b59FF08ebA622afB8fEf6BBbDf7FB",
  "0x59e408b9976B738e51e59c78585B643E635C73b9",
  "0x027aBf2e14bc9Aa5126CF0dE7Aa687B474776383",
  "0x0c67e9d91Cf30BEFa3B1887755A303881f858AFe",
  "0x4C2337F62AD04e17078dB2A8d0e0122622189c3D",
  "0x44821DbD39344ddD22374618Db215129be089bAD",
  "0xf963230C2256c0dC955CbA6D27eb7B140332f79C",
  "0x7436297B526833B424560264484415157961Aac0",
  "0xAAC98D26f483FCbc10Aa849f01f82D50fb162567",
  "0x02f39416Ca9d9020f78C56F95c78BC70b4468Ac9",
  "0x49bEacf7c5ce65b1ddAf2534e7612aedAA8B7F63",
  "0x4bcdc3e5ff4fc5af6eb342cee207ffa43a8355ba",
  "0xBDDa00CC6359633842E1713dd96267b0CD62E4B7",
  "0xdB80f0A92dCee6c1C8bE070711484127A1975cf7",
  "0x0A70711f2f6e76F5C5cA41a30147dFC862a27C37",
  "0xbd8E37d657AC90Ce5AFDe8a050a6D828eB49209c",
  "0x8863CdF7262DF190DE7504e3FF65eD11bD374275",
  "0xf3A0925f4a7e7E7ee7eBb8eF43AD85a17cd033EF",
  "0x1280fe9EEC7936Fdf29866e989f6f67138172c19",
  "0x7777777BCb976a2255C7fEAa594F70D9FA7EDf10",
  "0xdc94de8fc3902df5172EF3F514402EAD57Ac9A3d",
  "0xde4822873CC3941BB39f3921087d0118fb6B8c3C",
  "0x55d6d6198141297a67c75884814b9d5a79048864",
  "0xd9655eB871A5f657e2e5D2d07f3cA2d18b4Cb78A",
  "0x2A0e1C741e055D7AF4213028Ccd69fc77299bad4",
  "0xECD1f3E99cAA4cdbf174ad12ce79D89a8Ba54Fca",
  "0xab0e7adEe0E227896E3a5eBe99520b9961faED9F",
  "0x2b7E0a55109Dc0C68Ab848774207694Da99Ebc86",
  "0x1E8e214Ae5f9b58e415B4A1e80ecc2D83DBE5a8e",
  "0x939d8f09e002EaF17E10acaB804164becE5B8e3c",
  "0x0ac84c61178ff5ec660c95071ae9a5bc18be470a",
  "0x558ce3e68aE3A15f8a1f836e30207C4656D73026",
  "0x632Fd6EAeef1c1Cf61534D9e3082A4F229976907",
  "0x23854ED6B0815F5F7Aa5B220D11a34F7A7618363",
  "0xc553909Abd88cDDab4d8bcD98BFd446419bf5c9D",
  "0x32BD99e82A2fC6786Bb9474dFbfE25d8D959E199",
  "0xA89d2b8B73d3695e106B0BfE7C4eC09fD3aD7aDd",
  "0x762519a63Db86cc2C6D3C866FEA18eFd67a9dbfF",
  "0xDf85a009034088C368B92910857BcdfC38b104FB",
  "0x202BE58A82dd9aF2A9C89Eb76F31B684dDeA8256",
  "0xb2bC832c51FA1358060F70D30EAd7606fbAd85b7",
  "0xfaf34d9362a47c9a3902b1c73f68675015a668c1",
  "0xE751D56c31DC1B16595a2CdfC94388687E26a674",
  "0x006a4E423b643bf396bbA2f0a6e6F41B3ed25B86",
  "0x770C85396D40546561714F4c31DBC9BD1F4c3809",
  "0xddB4590732fe6920ac33d84E5af820a2D991f1B5",
  "0x9d7C96818FbAB7289261751319a81f581354E8ca",
  "0xa6263B9CD63C355871a9a5033B889d67dACA326B",
  "0x0E1ca0c78C85457e04DD6F256b290f6c31B7629A",
  "0x824056d84937598fC38456158a24f2687c344b39",
  "0x9aE8E9d881A091d872796457CEd62B4726065239",
  "0x3b85eb9fD62e1b1b211104607ea2341Fa03b2AB7",
  "0xcff5B5152e34804A8FAA8d763E923c82f4232a1D",
  "0x8464217534F118DE1afd1E22793F518c64C72B3e",
  "0xb12744a3083e8f010421A7d3D57f8AcBCe995c7F",
  "0x536B84deb52f4Cf67aE6f289A9F1C20590fC1D1A",
  "0x7913a1AB01DD0758E082cBa6017A5c1094EE141E",
  "0x6Fd5Bdb3F0cD1C5BA7dec4A30C674298c4542448",
  "0xcb70F6A5E95c2803e1f8D20e9B2C05BBd1d20dEF",
  "0x3A13724EeDeBcAd79601692c14E5efC2f053F8ba",
  "0x75E31b546eFA0FaE1D3652054c1340b6FeAD26ce",
  "0x6CFf836559e5aF7dCA1528dCb23E2692C4094A76",
  "0x79e785D56CB54b50bbA2C9f72dd515D0A59F393F",
  "0x726770c536bdF2F7b81B30f507D616FC271e91f0",
  "0x678e449Eef5faf4B64Fd1323d84ee153B19121ab",
  "0x992ab8E7C6850C43DC191A5D41d10Ab9DE15Cd21",
  "0x2DFDA8db71BDBEB43bbaCaEd68E47351E7217a80",
  "0xDAb9Dc2263F97F1Da26c285278905774491850df",
  "0x35f380933aA3567cC050FA8b7D3A800cA0a2498F",
  "0x28e37EC68c911a9e12a72a9Bb693a6AD8C60D11F",
  "0x96371a9AFDfE3E5545c94d06Ce9a0908515ce535",
  "0xf35B5A8ac19d2aC084D0363F9d7f31bfE6361cc5",
  "0xD44Ce1f69A1D316d7A4C85d50eC1610117362AC0",
  "0x4be1ae334dc08a5c97e47da83918fdc7f8a3e581",
  "0xB7af791B0C5b7FE29AFA8a7671323aD9D47ea9CE",
  "0xA03c3363dF7c84050497B2be8650778673D35B0d",
  "0xc8336B9DABBac9bFB9Aa483E76fc351B13121784",
  "0xa0438E1f0D83815eB005809314e62bd7Af2C2b8a",
  "0xffE8fE19F70266745857Cc58f4F8317f2CdB99C5",
  "0x2a93B9486922BBad643846245294aD2540fA55B7",
  "0x564Cd5E7D7E2dcFEDB7F186f39262bc60C93565f",
  "0x6995778edc482c4591206f37b6d702601437d9a1",
  "0xdbCc6698d4686EE3fba49c2245072460594efE6E",
  "0xA868590C01A99457341caA07362BbF478BB630D6",
  "0xb5b4df488b7b9a3ba7ee9d39756323e44a6468b1",
  "0x3A6154998397441C7DA755e93eEcC2f2460Be365",
  "0x2D40993411ADA73be84570a5bb399CBDc47d544E",
  "0xB0702df54657D6E739A949462c94CF508fb7bB64",
  "0x3c1EE8B2E80D86a46c5ed8D239F005F992Ec17f1",
  "0x163Aa77c6620F49c6Bf3bbA77133AF91A86f36f4",
  "0x82359081c428d0dc548202260b82ed4917669ecf",
  "0x94446Fc7B099aC0f2177ae40eB1EB4D11BaE6536",
  "0x80b8c9F846DF16D02DEEE062Fd7A0A73Ad6F2B66",
  "0x0C17B2A1489dcD092061B8241095a73775afF300",
  "0x7fB674ABDe76C777B56cD362b8Fd16389254a342",
  "0x0573B80d670d8A1793d4a2Aa086d9e5059e2fa35",
  "0x71cc0e32b2aBd066558DebA0E47bee9BD8F5ADA7",
  "0xb5ed88aBF4bE6Bd4cf655f83665bD7D6bfFd32a4",
  "0x48C1b8dD6f1C2B95c13898125284830Ad8328655",
  "0x53afd1f439c48c41f52B9F1A5E6Db4372BCACB63",
  "0x2028848533eE01931bdE47cfcd2DBbc237EcDfE2",
  "0x4C026d5D6A7fe1B2e2B28B916Ef2016f6058F7B4",
  "0xBE50DAa2f52A9C248E30b85E1A0fC364CC2D4713",
  "0xbE0e177b32C751e122af49b257aDE900114AD53e",
  "0x7D4833F0a04A1aCD4Ec957e71622bcEb95F1fA90",
  "0x9A13Ddc34074AbEE0D1d2353cCf418351770b8Bd",
  "0x74175e64722250610A89864a991853B6679Ff841",
  "0x90399B252A162beBcf5a4efc43DF06e33EC0686A",
  "0x15F1D5830EcD8b777b2eFBb9b0676e39142656b0",
  "0x67A7d08b402aD949FcC34Df5467b61229123cD10",
  "0xbd909b92e28d15c4322c2435acfecc1bf700307f",
  "0x1bb617144d8793fd988a6778C96Bd1CE01787C07",
  "0x7e22cd7C56075Ca68F842c981ec72d16946D4Acc",
  "0xee93C83549A35AC3eB0987c198Ce982907b2F4BD",
  "0x3b41587656680B0D617126cB14032Ae60A0e7F55",
  "0xFc7ebd042b984845cAB0f4Ba8593946bC3015c89",
  "0xd0b551b098604f28cedeed396179ff58883de201",
  "0x2c66440DFc093Cb5698d54f3C64b64f1A2c6C1c0",
  "0x85E2C567fACAE26bDED1A2CFD1e01e51CD57B23B",
  "0x452647A7399F46252543D6be5D093F90987F2b7F",
  "0x8Ba41690063b0f8257c536815baF3152D65c6B5f",
  "0xE0e4Ba0030FB1a7675666747DD1343eFb8A032F0",
  "0x9114E410502DafB8501b2bB971c3B6bae2b312e0",
  "0xD410477ca217c8Cd4e7908f8Ca872B1d0F127f0e",
  "0xDEcC75A69fdddbF35deD93c1efb8BF124D28C361",
  "0xe9b859d604cacc4e52d2ba0ee9f11e56365cc3c9",
  "0x0230F604a7697607FA07376E15f6a46EF1AfF513",
  "0x21D141bcb511E6251bcDB9e58bd3D6ccA498c044",
  "0xE8f130AbAc2B2eA79e8eC8A157B68E703de3E30C",
  "0xcC760C3fB88B664c2471563a9BbF4190978Fb060",
  "0xFA9710f88cF8A36c9fe1e5b815EBfe8361B35f32",
  "0xE4fE61197240D2Ea65eDab2710E45Dae0ea0De78",
  "0x0a072078398a9a3dd0d06da7c9e5828b04c2b9fc",
  "0xF5Fc910757B8e7c39B9E0fc8351b4418560C74F3",
  "0xE89B01e78a8A71Ef3B31CDa95f2Aa93464f79CDD",
  "0xF84644722bBb0228933092E41d5139a8503D4E4A",
  "0x000f5AfE6547CD318494Ffb56C8392750CEB7D59",
  "0x48382BA54089a9337ccb034621Ebb455Dc2e1077",
  "0x439fC79E2e62c338706b719E65A805425777B228",
  "0x483F4fF3FcdDb2eEF516C228E9A62Cc069DA9418",
  "0x9b3518Cca0Ef30e0b836689f56467D42A434D77f",
  "0x3c372359995a3966B648df1251aa548eFd6C71cb",
  "0x417bFc4f195Dc28b300b354582b840Bc743E1b5A",
  "0x99b4c858af64190732b2bae9fc603777ad2a7526",
  "0xE5D66027820d72b89bcF8Af292330BC40B18fc4B",
  "0x37205a67ad46ea0097ecfd900a89A1550127a249",
  "0x700f4f59982ca6267fe1f674564bfaf124efe210",
  "0x96F935D2d6437a35C2A6aF6195d0B25B54d6af01",
  "0x91df05eC7c22eA6683e2085deF53448ee0592978",
  "0x3E5fce21497Ba4aCff43e7F3111b85C47cfaDdF4",
  "0x236Ca347010B7c11b1f4A47E9beaa4409D1fAB4e",
  "0x48D536788Ad000Bc90F046e65ECF45F8e74b53eA",
  "0x1E18A291e08bf0Bec531Ea86141b950e1e0Dc88D",
  "0xa747559Cf2626128f51bac6fa73d6120250c47C4",
  "0xEb0c2226535aB7A08EefdBA0BA7aFD9bb6128b57",
  "0x9e7D5D7F0c7Cd6E8FC27cE76957E52760dC730B5",
  "0xace0f593cf6871d6187cc32eb795f42a6aac635a",
];

let data = [];

// This function creates a merkle tree from the provided address variable, printing the root hash.
function createTree() {
  //  Hashing All Leaf Individual
  const leaves = address.map((leaf) => keccak256(leaf));

  // Constructing Merkle Tree
  const tree = new MerkleTree(leaves, keccak256, {
    sortPairs: true,
  });

  //  Utility Function to Convert From Buffer to Hex
  const buf2Hex = (x) => "0x" + x.toString("hex");

  // Get Root of Merkle Tree
  console.log(`Here is Root Hash: ${buf2Hex(tree.getRoot())}`);
  createProofs(tree)
}

// This function loops through the whitelised addresses and creates the proof used to verify their claim
// if you had a frontend you would allow the user to sign in then do these operation on their singular wallet.
// FLOW: Wallet sign in -> capture wallet address -> create proof -> user creates transaction sending newly created proof as a param -> verify proof on chain.
function createProofs(tree) {
  // Pushing all the proof and leaf in data array
  address.forEach((address) => {
    const leaf = keccak256(address);

    const proof = tree.getProof(leaf);

    let tempData = [];

    proof.map((x) => tempData.push(buf2Hex(x.data)));

    data.push({
      address: address,
      leaf: buf2Hex(leaf),
      proof: tempData,
    });
  });

  // Create WhiteList Object to write JSON file
  let whiteList = {
    whiteList: data,
  };

  //  Stringify whiteList object and formating
  const metadata = JSON.stringify(whiteList, null, 2);

  // Write whiteList.json file in root dir
  fs.writeFile(`whiteList.json`, metadata, (err) => {
    if (err) {
      throw err;
    }
  });
}

createTree();
